# Web3é¡¹ç›®æ·±åº¦åˆ†ææŠ¥å‘Šå¹³å°

ä¸€ä¸ªåŸºäºFlaskå’ŒSupabaseçš„Web3é¡¹ç›®æ·±åº¦åˆ†ææŠ¥å‘Šç®¡ç†å¹³å°ï¼Œæ”¯æŒç”¨æˆ·æµè§ˆåˆ†ææŠ¥å‘Šã€æäº¤é¡¹ç›®è¯·æ±‚ï¼Œä»¥åŠç®¡ç†å‘˜åå°ç®¡ç†åŠŸèƒ½ã€‚

> âœ… å·²ä¿®å¤ Vercel éƒ¨ç½²é—®é¢˜ - æ”¯æŒ serverless ç¯å¢ƒå’Œ Supabase Storage

## åŠŸèƒ½ç‰¹æ€§

### å…¬å…±åŠŸèƒ½
- ğŸ“Š **æŠ¥å‘Šåˆ—è¡¨é¡µé¢**: åˆ†é¡µæ˜¾ç¤ºå·²å‘å¸ƒçš„æ·±åº¦åˆ†ææŠ¥å‘Š
- ğŸ” **æœç´¢åŠŸèƒ½**: æ”¯æŒé¡¹ç›®åç§°çš„æ¨¡ç³Šæœç´¢
- ğŸ“± **å“åº”å¼è®¾è®¡**: é€‚é…ç§»åŠ¨ç«¯å’Œæ¡Œé¢ç«¯
- ğŸ“„ **æŠ¥å‘Šè¯¦æƒ…**: æ”¯æŒMarkdownæŠ¥å‘Šå’ŒHTMLäº¤äº’å¼åˆ†æé¡µé¢
- ğŸ“ **é¡¹ç›®è¯·æ±‚**: ç”¨æˆ·å¯ä»¥ç”³è¯·ç ”ç©¶æ–°é¡¹ç›®

### ç®¡ç†å‘˜åŠŸèƒ½
- ğŸ” **å®‰å…¨è®¤è¯**: ç®¡ç†å‘˜ç™»å½•ç³»ç»Ÿ
- ğŸ“Š **ä»ªè¡¨æ¿**: ç»Ÿè®¡æ•°æ®å’Œå¿«é€Ÿæ“ä½œ
- ğŸ“‹ **æŠ¥å‘Šç®¡ç†**: åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤æ·±åº¦åˆ†ææŠ¥å‘Š
- ğŸ“¥ **è¯·æ±‚ç®¡ç†**: å¤„ç†ç”¨æˆ·æäº¤çš„é¡¹ç›®è¯·æ±‚
- ğŸ“ **æ–‡ä»¶ä¸Šä¼ **: æ”¯æŒMarkdownå’ŒHTMLæ–‡ä»¶ä¸Šä¼ 
- ğŸ“§ **é‚®ä»¶é€šçŸ¥**: è‡ªåŠ¨é€šçŸ¥ç”¨æˆ·è¯·æ±‚å¤„ç†ç»“æœ

## æŠ€æœ¯æ ˆ

- **åç«¯**: Flask, Python 3.8+
- **æ•°æ®åº“**: Supabase (PostgreSQL)
- **å‰ç«¯**: Bootstrap 5, jQuery
- **è®¤è¯**: Flask-Login
- **æ–‡ä»¶å¤„ç†**: Werkzeug
- **Markdown**: Python-Markdown
- **é‚®ä»¶**: SMTP

## å®‰è£…å’Œè®¾ç½®

### 1. å…‹éš†é¡¹ç›®
```bash
git clone <repository-url>
cd defix
```

### 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
```bash
python -m venv venv
source venv/bin/activate  # Linux/Mac
# æˆ–
venv\Scripts\activate  # Windows
```

### 3. å®‰è£…ä¾èµ–
```bash
pip install -r requirements.txt
```

### 4. é…ç½®ç¯å¢ƒå˜é‡
å¤åˆ¶ `.env.example` ä¸º `.env` å¹¶å¡«å†™é…ç½®ï¼š

```bash
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š
```env
# Supabaseé…ç½®
SUPABASE_URL=your_supabase_project_url
SUPABASE_KEY=your_supabase_anon_key
SUPABASE_SERVICE_KEY=your_supabase_service_role_key

# Flaské…ç½®
FLASK_SECRET_KEY=your_secret_key_here
FLASK_ENV=development
DEBUG=True

# é‚®ä»¶é…ç½®ï¼ˆå¯é€‰ï¼‰
SMTP_SERVER=smtp.gmail.com
SMTP_PORT=587
EMAIL_USERNAME=your_email@gmail.com
EMAIL_PASSWORD=your_app_password
FROM_EMAIL=your_email@gmail.com
```

### 5. è®¾ç½®Supabaseæ•°æ®åº“
1. åœ¨Supabaseæ§åˆ¶å°åˆ›å»ºæ–°é¡¹ç›®
2. åœ¨SQLç¼–è¾‘å™¨ä¸­è¿è¡Œ `database/schema.sql` ä¸­çš„SQLè„šæœ¬
3. è·å–é¡¹ç›®URLå’ŒAPIå¯†é’¥ï¼Œå¡«å…¥ `.env` æ–‡ä»¶

### 6. åˆå§‹åŒ–æ•°æ®
```bash
python create_admin.py
```

è¿™å°†åˆ›å»ºï¼š
- é»˜è®¤ç®¡ç†å‘˜è´¦æˆ· (admin@example.com / admin123)
- ç¤ºä¾‹ç ”ç©¶æŠ¥å‘Šæ•°æ®
- ç¤ºä¾‹ç”¨æˆ·è¯·æ±‚æ•°æ®

### 7. è¿è¡Œåº”ç”¨
```bash
python run.py
```

åº”ç”¨å°†åœ¨ `http://localhost:5000` å¯åŠ¨ã€‚

### 8. è¿è¡Œæµ‹è¯•

æ‰€æœ‰æµ‹è¯•ä»£ç å·²ç»Ÿä¸€æ•´ç†åˆ° `test/` ç›®å½•ä¸‹ã€‚è¿è¡Œæµ‹è¯•ä»¥ç¡®ä¿åº”ç”¨æ­£å¸¸å·¥ä½œï¼š

```bash
# è¿è¡Œæ ¸å¿ƒæµ‹è¯•ï¼ˆæ¨èï¼‰
python test/run_core_tests.py

# è¿è¡Œæ‰€æœ‰æµ‹è¯•
python test/run_all_tests.py

# è¿è¡Œå•ä¸ªæµ‹è¯•æ¨¡å—
python test/test_deployment.py
python test/test_final_verification.py
python test/test_supabase.py
```

#### æµ‹è¯•æ¨¡å—è¯´æ˜

- `test/run_core_tests.py` - æ ¸å¿ƒæµ‹è¯•è¿è¡Œå™¨ï¼ˆæ¨èä½¿ç”¨ï¼‰
- `test/run_all_tests.py` - å®Œæ•´æµ‹è¯•å¥—ä»¶è¿è¡Œå™¨
- `test/test_deployment.py` - éƒ¨ç½²éªŒè¯æµ‹è¯•
- `test/test_final_verification.py` - æœ€ç»ˆåŠŸèƒ½éªŒè¯
- `test/test_supabase.py` - æ•°æ®åº“è¿æ¥æµ‹è¯•
- `test/test_admin_templates.py` - ç®¡ç†å‘˜æ¨¡æ¿æµ‹è¯•
- `test/test_app.py` - åŸºç¡€åº”ç”¨æµ‹è¯•

è¯¦ç»†æµ‹è¯•è¯´æ˜è¯·æŸ¥çœ‹ `test/README.md`ã€‚

## ä½¿ç”¨è¯´æ˜

### å…¬å…±ç”¨æˆ·
1. è®¿é—®é¦–é¡µæŸ¥çœ‹æ·±åº¦åˆ†ææŠ¥å‘Šåˆ—è¡¨
2. ä½¿ç”¨æœç´¢åŠŸèƒ½æŸ¥æ‰¾ç‰¹å®šé¡¹ç›®
3. ç‚¹å‡»"åˆ†æ"æŸ¥çœ‹äº¤äº’å¼åˆ†æé¡µé¢
4. ç‚¹å‡»"æŠ¥å‘Š"æŸ¥çœ‹è¯¦ç»†çš„MarkdownæŠ¥å‘Š
5. å¦‚æœæ‰¾ä¸åˆ°æƒ³è¦çš„é¡¹ç›®ï¼Œå¯ä»¥ç‚¹å‡»"ç”³è¯·æ–°é¡¹ç›®"æäº¤è¯·æ±‚

### ç®¡ç†å‘˜
1. è®¿é—® `/admin/login` ç™»å½•ç®¡ç†åå°
2. åœ¨ä»ªè¡¨æ¿æŸ¥çœ‹ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯
3. åœ¨"æŠ¥å‘Šç®¡ç†"ä¸­æ·»åŠ ã€ç¼–è¾‘æˆ–åˆ é™¤æ·±åº¦åˆ†ææŠ¥å‘Š
4. åœ¨"ç”¨æˆ·è¯·æ±‚"ä¸­å¤„ç†ç”¨æˆ·æäº¤çš„é¡¹ç›®ç”³è¯·
5. ä¸Šä¼ MarkdownæŠ¥å‘Šæ–‡ä»¶å’ŒHTMLåˆ†ææ–‡ä»¶

## é¡¹ç›®ç»“æ„

```
defix/
â”œâ”€â”€ app/                    # åº”ç”¨ä¸»ç›®å½•
â”‚   â”œâ”€â”€ models/            # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ views/             # è§†å›¾æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ services/          # æœåŠ¡å±‚
â”‚   â””â”€â”€ utils/             # å·¥å…·å‡½æ•°
â”œâ”€â”€ templates/             # HTMLæ¨¡æ¿
â”‚   â”œâ”€â”€ admin/            # ç®¡ç†å‘˜æ¨¡æ¿
â”‚   â””â”€â”€ public/           # å…¬å…±æ¨¡æ¿
â”œâ”€â”€ static/               # é™æ€æ–‡ä»¶
â”‚   â”œâ”€â”€ css/             # æ ·å¼æ–‡ä»¶
â”‚   â”œâ”€â”€ js/              # JavaScriptæ–‡ä»¶
â”‚   â””â”€â”€ images/          # å›¾ç‰‡æ–‡ä»¶
â”œâ”€â”€ uploads/              # ä¸Šä¼ æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ reports/         # MarkdownæŠ¥å‘Šæ–‡ä»¶
â”‚   â””â”€â”€ analysis/        # HTMLåˆ†ææ–‡ä»¶
â”œâ”€â”€ database/             # æ•°æ®åº“è„šæœ¬
â”œâ”€â”€ requirements.txt      # Pythonä¾èµ–
â”œâ”€â”€ run.py               # åº”ç”¨å¯åŠ¨æ–‡ä»¶
â””â”€â”€ create_admin.py      # åˆå§‹åŒ–è„šæœ¬
```

## APIæ¥å£

### å…¬å…±æ¥å£
- `GET /` - é¦–é¡µï¼Œæ˜¾ç¤ºæŠ¥å‘Šåˆ—è¡¨
- `GET /report/<id>/analysis` - æŸ¥çœ‹åˆ†æé¡µé¢
- `GET /report/<id>/report` - æŸ¥çœ‹æŠ¥å‘Šé¡µé¢
- `POST /request-project` - æäº¤é¡¹ç›®è¯·æ±‚

### ç®¡ç†å‘˜æ¥å£
- `GET /admin/login` - ç™»å½•é¡µé¢
- `GET /admin/dashboard` - ç®¡ç†ä»ªè¡¨æ¿
- `GET /admin/reports` - æŠ¥å‘Šç®¡ç†
- `POST /admin/reports/create` - åˆ›å»ºæŠ¥å‘Š
- `GET /admin/requests` - è¯·æ±‚ç®¡ç†

## éƒ¨ç½²

### ç”Ÿäº§ç¯å¢ƒé…ç½®
1. è®¾ç½® `FLASK_ENV=production`
2. ä½¿ç”¨å¼ºå¯†ç å’Œå®‰å…¨çš„SECRET_KEY
3. é…ç½®HTTPS
4. è®¾ç½®æ–‡ä»¶ä¸Šä¼ é™åˆ¶
5. é…ç½®é‚®ä»¶æœåŠ¡

### ä½¿ç”¨Gunicornéƒ¨ç½²
```bash
pip install gunicorn
gunicorn -w 4 -b 0.0.0.0:8000 run:app
```

## è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ã€‚

## è®¸å¯è¯

MIT License

## æ”¯æŒ

å¦‚æœæ‚¨åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š
1. æŸ¥çœ‹æ–‡æ¡£å’ŒFAQ
2. æœç´¢å·²æœ‰çš„Issues
3. åˆ›å»ºæ–°çš„Issueæè¿°é—®é¢˜

---

**æ³¨æ„**: è¿™æ˜¯ä¸€ä¸ªæ¼”ç¤ºé¡¹ç›®ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨å‰è¯·ç¡®ä¿è¿›è¡Œå……åˆ†çš„å®‰å…¨æµ‹è¯•å’Œé…ç½®ã€‚
